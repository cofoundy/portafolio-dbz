---
import { Image } from 'astro:assets';
import { getEntry } from 'astro:content';
import Button from '../ui/Button.astro';
import BentoCard from '../ui/BentoCard.astro';
import Scrollytelling from './Scrollytelling.astro';

import photoPerfil from '../../assets/images/daniel-bonifaz-perfil.jpg';

const personalData = await getEntry('site', 'personal');
const personal = personalData!.data;
---

<BentoCard variant="default" size="xl" span="col-span-2 row-span-2 md:col-span-3" id="intro">
  <!-- Botón cerrar (solo visible en modo expandido) -->
  <button
    id="scrollytelling-close"
    class="intro-close-btn absolute right-4 top-4 z-10 grid h-10 w-10 place-items-center rounded-full text-brand-400 transition-colors hover:bg-brand-800 hover:text-brand-50"
    aria-label="Cerrar ecosistema"
  >
    <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
    </svg>
  </button>

  <!-- Contenido original de la intro -->
  <div id="intro-default" class="flex flex-col justify-between flex-1">
    <div id="intro-hero">
      <div id="intro-text">
        <p class="text-sm font-medium text-accent">{personal.roles!.join(' · ')}</p>
        <h1 class="mt-3 text-3xl font-bold leading-tight tracking-tight text-brand-50 md:text-5xl lg:text-6xl">
          {personal.tagline}
        </h1>
        <p class="mt-4 max-w-xl text-base text-brand-300">
          {personal.name}
        </p>
        <div id="intro-buttons" class="mt-6 flex flex-col gap-3 md:flex-row md:flex-wrap">
          <Button variant="primary" size="md" class="w-full md:w-auto" id="btn-ecosistema" aria-expanded="false">Conoce el ecosistema</Button>
          <Button href="#newsletter" variant="secondary" size="md" class="w-full md:w-auto">Suscríbete al newsletter</Button>
        </div>
      </div>
      <Image
        src={photoPerfil}
        alt="Daniel Bonifaz Zegarra"
        id="intro-photo"
        class="intro-photo rounded-full border-2 border-accent/50 object-cover object-top"
      />
    </div>
    <!-- Visto en -->
    <div id="intro-visto-en" class="mt-8 flex flex-wrap items-center gap-2 border-t border-brand-700/50 pt-6 md:gap-4">
      <span class="text-xs uppercase tracking-wider text-brand-500">Visto en</span>
      {personal.credibilityLogos!.map((logo: string) => (
        <span class="text-xs font-medium text-brand-400 md:text-sm">{logo}</span>
      ))}
    </div>
  </div>

  <!-- Contenido del storytelling (oculto por defecto) -->
  <div id="intro-story" hidden>
    <Scrollytelling />
  </div>
</BentoCard>
